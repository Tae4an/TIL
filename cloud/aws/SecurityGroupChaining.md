# AWS Security Group Chaining이란?

## 개념 정의
AWS 시큐리티 그룹 체이닝(Security Group Chaining)은 **다른 시큐리티 그룹의 ID를 인바운드/아웃바운드 규칙의 소스/목적으로 직접 참조하여 네트워크 접근을 제어하는 방식**이다. 인스턴스(EC2 등)에 적용된 여러 시큐리티 그룹이 서로의 허용 규칙을 조합(연결)해, 복잡한 트래픽 흐름도 간결하고 유연하게 제어할 수 있다.

쉽게 말하면 “시큐리티 그룹끼리 직접 연결해서 엔드포인트 간 네트워크 허용을 동적으로 설계하는 AWS 네트워크 보안 아키텍처”다.

## 핵심 특징

**ID 기반 접근 제어**
- IP 주소 또는 CIDR뿐만 아니라, 특정 시큐리티 그룹의 ID를 소스/대상으로 직접 지정 가능
- 인스턴스의 IP가 변경되어도 시큐리티 그룹 단위로 접근권한 자동 유지

**유연한 네트워크 아키텍처 설계**
- EC2, ELB, RDS 등에서 서로 다른 시큐리티 그룹을 체인 형식으로 연결하여 서비스 영역별/역할별/환경별 접근을 세분화
- 마이크로서비스 아키텍처, 환경별(개발/운영/테스트) 보안 경계 구현

**다중 그룹 조합**
- 인스턴스에 여러 시큐리티 그룹 동시 적용 가능
- 각 그룹의 허용/차단 규칙이 OR 조건으로 합산, 유연한 접근 제어

**자동화와 유지보수 용이**
- 인스턴스 교체, IP 변동 등 상황에서도 그룹ID 기반 연결로 운용 손쉬움
- 인프라-as-코드(IaC) 및 동적 구성에 적합

## 활용 구조 예시

**Web–App–DB 3 Tier 아키텍처**
- web-tier SG: 인터넷에서 접근 허용(80, 443)
- app-tier SG: 소스 그룹(web-tier SG)에서만 인바운드 허용(8080 등)
- db-tier SG: 소스 그룹(app-tier SG)에서만 인바운드 허용(3306, 5432 등)
- 각 Tier별 분리·접근 제한, 코드/관리 효율성↑

**마이크로서비스/VM간 보안 경계**
- 서비스별 SG 생성 → 신뢰하는 서비스의 SG만 소스에 추가
- 배포·확장·변경 시 SG 체이닝 방식으로 네트워크 보안 일관성 유지

## 핵심 워크플로

### 1. 시큐리티 그룹 생성 및 규칙 추가
```bash
# app-tier SG가 web-tier SG에서만 접근 허용
aws ec2 authorize-security-group-ingress \
  --group-id <app-sg-id> \
  --protocol tcp \
  --port 8080 \
  --source-group <web-sg-id>
```

### 2. 인스턴스에 SG 적용 및 유지
- EC2 인스턴스, RDS, ELB 등에서 관련 SG를 동시 적용
- SG 변경 시, 소스 SG ID를 추가/삭제하여 트래픽 흐름 즉시 제어

### 3. 관리 및 확장
- IaC(Terraform, CloudFormation 등) 사용 시 SG 체이닝 구조 코드로 선언
- 관리 편의·자동화·복잡한 보안 정책 구현 시 활용

## 이점 및 유의사항

**장점**
- IP변경·오토스케일링 환경에도 유동적으로 연결 안전 보장
- 네트워크 확장, 신규 서비스 추가 시 코드·설정만 변경하면 자동 적용
- 정책/보안 기준 명확 유지, 운영 효율성 매우 높음

**유의사항**
- 규칙이 많아지면 SG 구조 확산 및 관리 복잡성 발생 우려
- 접근 경로 순환 등으로 의도치 않은 트래픽 수도 생길 수 있어 구조 설계에 주의 필요
- SG간 체인 구조, 애플리케이션 Role별 보안 경계 명확히 문서화·표준화 권장

AWS 시큐리티 그룹 체이닝은 대규모/마이크로서비스/분리 환경에서 역할 기반 네트워크 보안과 자동화된 트래픽 제어를 위해 매우 효과적인 방법이며, 현대적인 클라우드 보안 아키텍처 설계의 필수 패턴 중 하나다.
