# AWS GuardDuty란?

## 개념 정의
**AWS GuardDuty**는 AWS 환경에서 **지능형 위협 탐지 서비스**다. 머신러닝, AI, 위협 인텔리전스를 활용하여 악의적 활동과 무단 동작을 지속적으로 모니터링하고 탐지한다.

클라우드 환경에서 발생하는 다양한 보안 위협을 **실시간으로 감지하는 보안 모니터링** 서비스다.

## 핵심 특징

### **완전 관리형 서비스**
- 별도 소프트웨어나 인프라 배포 없이 **원클릭으로 활성화** 가능하다
- AWS가 모든 관리를 담당하여 운영 부담이 없다
- 자동으로 확장되어 조직 규모에 관계없이 동작한다

### **지속적 모니터링**
- AWS 환경의 모든 활동을 **24시간 실시간 분석**한다
- 수십억 개의 이벤트를 동시 처리하여 위협을 탐지한다
- 별도 로그 활성화 없이도 기본 데이터 수집 및 분석 수행

### **머신러닝 기반 탐지**
- AWS와 업계 위협 인텔리전스를 결합한 **고도화된 분석 엔진**을 사용한다
- 악성 IP 주소, 도메인, 파일 해시 등을 활용한 정확한 위협 식별
- 행동 분석을 통한 이상 징후 탐지 기능

## 데이터 소스

### **기본 데이터 소스** (무료)
- **CloudTrail 로그**: API 호출 및 계정 활동 모니터링
- **VPC Flow 로그**: 네트워크 트래픽 패턴 분석
- **DNS 로그**: 도메인 조회 활동 추적 (Route 53 한정)

### **확장 데이터 소스** (추가 비용)
- **S3 데이터 이벤트**: 버킷 접근 및 데이터 유출 탐지
- **EKS 감사 로그**: Kubernetes 클러스터 보안 모니터링
- **RDS 로그인 이벤트**: 데이터베이스 비정상 접근 탐지
- **Runtime Monitoring**: EC2, ECS, EKS의 실행 시점 위협 탐지
- **Malware Protection**: EC2 볼륨과 S3 버킷의 악성코드 스캔

## 주요 탐지 위협

### **계정 침해**
- 손상되거나 유출된 AWS 자격 증명 사용
- 비정상적인 지리적 위치에서의 접근
- 이례적인 시간대의 계정 활동

### **데이터 보안 위협**
- 랜섬웨어로 이어질 수 있는 데이터 유출 및 파괴
- S3 버킷의 무단 접근 및 데이터 탈취
- 비정상적인 대용량 데이터 전송

### **인프라 침해**
- EC2 인스턴스의 무단 크립토마이닝 활동
- 컨테이너 워크로드의 악성 활동
- 멀웨어 감염 및 확산

### **네트워크 위협**
- 악성 IP 주소와의 통신
- 봇넷 활동 및 C&C 서버 통신
- DNS 터널링 및 DGA 도메인 접근

## 탐지 결과 분류

### **심각도 수준**
- **Low (0.1-3.9)**: 의심스러운 활동이지만 즉각적 위험은 낮음
- **Medium (4.0-6.9)**: 추가 조사가 필요한 중간 위험도 활동
- **High (7.0-8.9)**: 높은 확신도의 악성 활동으로 즉시 대응 필요

### **위협 유형별 분류**
- **Backdoor**: 백도어 및 원격 접근 도구
- **Cryptocurrency**: 크립토마이닝 활동
- **Malware**: 악성코드 및 바이러스
- **Reconnaissance**: 정찰 및 스캔 활동
- **Trojan**: 트로이목마 및 스파이웨어

## 대응 자동화

### **EventBridge 통합**
- 탐지 결과를 EventBridge로 자동 전달한다
- Lambda 함수 트리거를 통한 자동 대응 워크플로 구성
- SNS 알림, Slack 통합 등 다양한 알림 채널 설정

### **보안 허브 통합**
- AWS Security Hub와 연동하여 중앙집중식 보안 관리
- 다른 보안 서비스와의 통합된 대시보드 제공
- 표준화된 보안 평가 프레임워크 적용

## 조직 차원 관리

### **다중 계정 지원**
- AWS Organizations와 통합하여 **최대 5,000개 계정** 관리
- 마스터 계정에서 모든 멤버 계정의 위협 탐지 통합 관리
- 계정별 설정 및 억제 규칙 중앙 집중 배포

### **위협 및 신뢰 목록**
- **Threat IP List**: 알려진 악성 IP 주소 목록 관리
- **Trusted IP List**: 신뢰할 수 있는 IP 주소 목록으로 오탐 방지
- CSV, TXT, STIX 형식 지원으로 외부 위협 인텔리전스 통합

## 제한사항

### **탐지 전용 서비스**
- 위협을 **탐지만 하고 차단하지는 않음**
- 실제 대응 조치는 별도 서비스나 자동화 구성 필요
- Detective, Lambda 등과 조합하여 종합적 보안 체계 구축 권장

### **DNS 로그 제약**
- Route 53 DNS 로그만 모니터링 가능
- 온프레미스 Active Directory DNS 서버 로그는 분석 불가
- 하이브리드 환경에서는 추가적인 DNS 로깅 구성 필요

## 비용 구조

### **기본 요금**
- 30일 무료 평가 기간 제공
- CloudTrail, VPC Flow 로그, DNS 로그 분석은 기본 포함
- 분석된 이벤트 수에 따른 단계별 요금제

### **추가 기능 요금**
- S3 데이터 이벤트, EKS 로그, RDS 로그 등은 별도 과금
- Runtime Monitoring 및 Malware Protection은 추가 비용 발생
- 사용량 기반 과금으로 실제 분석량에 따라 비용 결정

## 주요 활용 사례

### **클라우드 보안 모니터링**
- 전사 AWS 환경의 보안 위협 통합 관리
- SOC(Security Operations Center) 운영 지원
- 규정 준수 및 보안 감사 요구사항 충족

### **사고 대응 체계**
- 보안 사고의 조기 탐지 및 경보
- 포렌식 분석을 위한 상세한 위협 정보 제공
- 자동화된 초기 대응 프로세스 구축

AWS GuardDuty는 **클라우드 환경의 포괄적 보안 감시**를 제공하는 핵심 서비스로, 복잡한 위협 탐지를 간단하게 구현할 수 있는 필수적인 보안 도구다.
