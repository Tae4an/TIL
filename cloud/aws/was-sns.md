# AWS SNS란?

## SNS의 기본 정의

**AWS SNS(Simple Notification Service)는 Amazon Web Services에서 제공하는 완전 관리형 메시징 서비스다**. 애플리케이션, 최종 사용자, 디바이스 간에 메시지를 손쉽게 송수신할 수 있도록 해주는 pub/sub(발행/구독) 메시징 플랫폼이다.

**간단히 말해서, 하나의 메시지를 여러 곳에 동시에 전달해주는 방송국 같은 역할을 한다**. 마치 라디오 방송처럼 하나의 메시지를 발송하면 구독하고 있는 모든 대상에게 즉시 전달된다.

## SNS의 핵심 개념

## Pub/Sub 메시징 모델

**SNS는 발행/구독(Publisher/Subscriber) 모델을 기반으로 한다**:

| 구성 요소 | 역할 | 예시 |
| --- | --- | --- |
| **Publisher** | 메시지를 발행하는 주체 | 애플리케이션, Lambda 함수, CloudWatch 알람 |
| **Topic** | 메시지가 전송되는 통신 채널 | 주문 알림, 시스템 경고, 마케팅 메시지 |
| **Subscriber** | 메시지를 구독하는 대상 | 이메일, SMS, HTTP 엔드포인트, Lambda |

## 작동 원리

1. **토픽 생성**: 메시지를 전송할 주제별 채널 생성
2. **구독자 등록**: 해당 토픽을 구독할 대상들 설정
3. **메시지 발행**: Publisher가 토픽에 메시지 전송
4. **자동 배포**: SNS가 모든 구독자에게 동시 전달

## 지원하는 메시지 전송 방식

## 다양한 프로토콜 지원

**SNS는 여러 가지 방식으로 메시지를 전달할 수 있다**:

| 프로토콜 | 설명 | 활용 사례 |
| --- | --- | --- |
| **Email** | 이메일 주소로 메시지 전송 | 시스템 알림, 보고서 발송 |
| **SMS** | 휴대폰 문자 메시지 전송 | 긴급 알림, 인증 코드 |
| **HTTP/HTTPS** | 웹훅으로 메시지 전송 | API 연동, 외부 시스템 통합 |
| **Lambda** | AWS Lambda 함수 실행 | 자동화된 후속 처리 |
| **SQS** | 큐에 메시지 저장 | 안정적인 메시지 처리 |
| **Application** | 모바일 앱 푸시 알림 | 앱 사용자에게 실시간 알림 |

## 실제 활용 사례

## 1. 전자상거래 주문 처리

**온라인 쇼핑몰에서 주문이 들어왔을 때**:

```
고객 주문 발생
    ↓
SNS Topic: "새주문알림"
    ↓
├── 고객에게 SMS: "주문이 접수되었습니다"
├── 재고팀에게 이메일: "재고 확인 요청"
├── 배송팀 시스템 HTTP 호출: "배송 준비"
└── Lambda 함수 실행: "주문 데이터 분석"
```

## 2. 시스템 모니터링 알림

**서버에 장애가 발생했을 때**:

- CloudWatch에서 CPU 사용률 90% 초과 감지
- SNS 토픽으로 알람 메시지 발송
- 개발팀에게 이메일과 SMS 동시 전송
- 자동 복구 Lambda 함수 실행
- Slack 채널에 웹훅으로 알림 전송

## 3. 마케팅 캠페인

**신제품 출시 알림 발송**:

- 마케팅팀에서 하나의 메시지 작성
- 이메일 구독자들에게 상세 내용 전송
- SMS 구독자들에게 간략한 알림 전송
- 모바일 앱 사용자들에게 푸시 알림
- 파트너사 시스템에 API 호출

## SNS vs SQS 비교

## 메시징 패턴의 차이

| 특징 | SNS (Pub/Sub) | SQS (Queue) |
| --- | --- | --- |
| **전달 방식** | 1:N (하나에서 여러 곳으로) | 1:1 (하나에서 하나로) |
| **메시지 소비** | 모든 구독자가 동일한 메시지 수신 | 하나의 소비자만 메시지 처리 |
| **실시간성** | 즉시 전달 (Push 방식) | 폴링으로 확인 (Pull 방식) |
| **용도** | 알림, 브로드캐스트, 이벤트 전파 | 작업 큐, 배치 처리, 안정적 전달 |

## 함께 사용하는 패턴

**SNS + SQS를 조합한 팬아웃 패턴**:

- SNS로 메시지를 여러 SQS 큐에 동시 전송
- 각 큐에서 서로 다른 처리 로직 실행
- 실패한 메시지는 큐에서 재시도 처리

## SNS의 고급 기능

## 메시지 필터링

**구독자별로 받고 싶은 메시지만 선별 가능**:

```json
{
  "eventType": ["order", "payment"],
  "region": ["seoul", "busan"],
  "amount": [{"numeric": [">", 100000]}]
}
```

## 메시지 속성

**메시지에 추가 정보를 메타데이터로 포함**:

- 우선순위 설정
- 메시지 타입 분류
- 발송자 정보
- 타임스탬프

## 배치 발송

**최대 10개 메시지를 한 번에 전송하여 비용과 지연 시간 절약**

## 보안 및 권한 관리

## IAM 통합

**AWS IAM을 통한 세밀한 권한 제어**:

- 토픽 생성/삭제 권한
- 메시지 발행 권한
- 구독/구독 취소 권한
- 토픽별 접근 제어

## 암호화

**메시지 보안을 위한 다양한 암호화 옵션**:

- 전송 중 암호화 (HTTPS)
- 저장 중 암호화 (KMS 키 사용)
- 엔드투엔드 암호화

## 비용 구조

## 요금 체계

**사용량 기반 과금 모델**:

| 항목 | 무료 제공 | 추가 비용 |
| --- | --- | --- |
| **HTTP 요청** | 월 100만 건 | 100만 건당 $0.50 |
| **이메일** | 월 1,000건 | 1,000건당 $2.00 |
| **SMS** | - | 지역별 차등 ($0.006~$0.645) |
| **모바일 푸시** | 월 100만 건 | 100만 건당 $0.50 |

## 비용 최적화 팁

- **배치 발송 활용**: 개별 발송보다 비용 효율적
- **필터링 사용**: 불필요한 메시지 전송 방지
- **적절한 프로토콜 선택**: SMS보다 이메일이 저렴

## 모범 사례

## 토픽 설계

**명확한 토픽 분리**: 용도별, 중요도별로 토픽을 세분화하여 관리 용이성 향상

**네이밍 규칙**: 일관된 명명 규칙으로 토픽 관리 효율화

- `환경-서비스-이벤트` 형식 (예: `prod-order-created`)

## 오류 처리

**DLQ(Dead Letter Queue) 설정**: 전달 실패한 메시지를 별도 큐로 보관하여 나중에 분석 및 재처리

**재시도 정책**: 일시적 오류에 대한 적절한 재시도 횟수와 간격 설정

## 모니터링

**CloudWatch 메트릭 활용**:

- 발송 성공/실패율 모니터링
- 구독자별 전달 상태 추적
- 비정상적인 메시지량 감지 알람 설정

## SNS의 제한사항

## 기술적 제한

- **메시지 크기**: 최대 256KB
- **메시지 보관**: 실시간 전송만 지원, 저장소 기능 없음
- **순서 보장**: 기본적으로 메시지 순서 보장 안 함 (FIFO 토픽 별도 제공)
- **중복 방지**: 동일 메시지 중복 전송 가능성

## 대안 고려사항

**복잡한 워크플로우가 필요한 경우**: AWS Step Functions 고려

**대용량 데이터 처리**: Amazon Kinesis 활용

**실시간 양방향 통신**: AWS AppSync나 WebSocket API 사용

AWS SNS는 **현대 클라우드 아키텍처에서 마이크로서비스 간 통신과 이벤트 기반 아키텍처 구현에 필수적인 서비스**다. 간단한 설정으로 복잡한 메시징 시스템을 구축할 수 있으며, 다른 AWS 서비스들과의 뛰어난 통합성으로 확장 가능하고 안정적인 알림 시스템을 만들 수 있다.
