# AWS Instance Store란?

## 개념 정의

AWS Instance Store는 EC2 인스턴스의 호스트 서버에 물리적으로 연결된 임시 블록 스토리지다. 인스턴스 중지/종료 시 데이터가 삭제되며, 극도로 빠른 I/O 성능을 제공하는 휘발성 스토리지다.

쉽게 말해 "EC2 서버에 붙어있는 초고속 로컬 디스크로, 끄면 데이터가 날아가는 임시 저장소"다.

## 핵심 특징

- 호스트 서버에 물리적으로 직접 연결 (네트워크 없음)
- 인스턴스 중지/종료 시 데이터 삭제 (휘발성)
- 극도로 높은 I/O 성능 (수십만~수백만 IOPS)
- 추가 비용 없음 (인스턴스 비용에 포함)
- 크기 및 개수는 인스턴스 타입에 고정
- 인스턴스 실행 시에만 연결 가능

## 주요 특성

### 물리적 연결
호스트 컴퓨터의 로컬 디스크를 직접 사용하며, 네트워크 지연이 없어 매우 빠르다.

### 임시 스토리지
인스턴스가 다음 상황에서 데이터가 삭제된다.
- 인스턴스 중지 (Stop)
- 인스턴스 종료 (Terminate)
- 하드웨어 장애
- 호스트 마이그레이션

인스턴스 재부팅(Reboot)은 데이터가 유지된다.

### 고정된 용량
인스턴스 타입별로 개수, 크기, 유형이 정해져 있으며, 후에 추가하거나 분리할 수 없다. 예: i3.large는 475GB NVMe SSD 1개

### 높은 성능
NVMe SSD 기반으로 수십만~수백만 IOPS와 수 GB/s 처리량을 제공하며, EBS보다 지연시간이 낮다.

## 인스턴스 타입별 예시

**스토리지 최적화 (i, d 계열)**
- i3.large: 475GB NVMe SSD x1
- i3en.24xlarge: 7.5TB NVMe SSD x8 (60TB 총)
- d3.8xlarge: 2TB HDD x24 (48TB 총)

**범용 (c, m, r 계열)**
- c5d.large: 50GB NVMe SSD x1
- m5d.xlarge: 150GB NVMe SSD x1
- r5d.2xlarge: 300GB NVMe SSD x1

## Instance Store vs EBS

| 항목 | Instance Store | EBS |
|------|----------------|-----|
| 위치 | 호스트 서버 로컬 | 네트워크로 연결 |
| 영속성 | 휘발성 (삭제됨) | 영구 (독립 존재) |
| 성능 | 매우 높음 (직접 연결) | 높음 (네트워크 경유) |
| 스냅샷 | 불가 | 가능 |
| 인스턴스 중지 | 데이터 삭제 | 데이터 유지 |
| 크기 조정 | 불가 (고정) | 가능 |
| 추가 비용 | 없음 | 있음 |
| 적합 사례 | 임시 데이터 | 영구 데이터 |

## 주요 활용 사례

**캐시 및 버퍼**
Redis, Memcached 같은 인메모리 캐시의 백업 저장소로, 데이터 손실 시 재생성 가능한 경우에 사용한다.

**임시 파일 처리**
로그 처리, 이미지 변환, 동영상 인코딩 같은 임시 작업 파일 저장에 적합하며, 작업 완료 후 결과만 S3로 이동한다.

**스크래치 데이터**
빅데이터 분석, ETL 작업의 중간 결과물 저장에 사용하며, 최종 결과만 영구 저장소에 보관한다.

**복제된 데이터**
NoSQL 클러스터(Cassandra, MongoDB)처럼 여러 노드에 복제되는 데이터는 단일 노드 손실 시 복구 가능하므로, 고성능 Instance Store를 활용한다.

**고성능 데이터베이스**
임시 테스트 DB, 읽기 전용 복제본, 재생 가능한 데이터베이스에 사용하며, 극도로 낮은 지연시간이 필요한 경우 적합하다.

**HPC 워크로드**
시뮬레이션, 유전체 분석 등 대량 임시 데이터 처리 시 빠른 I/O가 필요한 경우 사용한다.

## 작동 방식

1. **인스턴스 선택**: Instance Store 지원 타입 선택 (예: i3, c5d, m5d)
2. **자동 연결**: 인스턴스 시작 시 자동으로 Instance Store 볼륨 연결
3. **파일 시스템 생성**: 초기 상태는 포맷되지 않았으므로 수동 포맷 필요
4. **데이터 사용**: 초고속 로컬 스토리지로 활용
5. **데이터 손실**: 인스턴스 중지/종료 시 모든 데이터 삭제

## 모범 사례

**영구 데이터는 EBS/S3 사용**
중요한 데이터는 Instance Store에 저장하지 않으며, 주기적으로 EBS나 S3로 백업한다.

**복제 전략 구현**
데이터를 여러 인스턴스에 복제하여 단일 장애 시에도 복구 가능하도록 설계한다.

**Auto Scaling 주의**
Instance Store 인스턴스는 중지할 수 없으므로, Auto Scaling 시 종료 후 재생성되며 데이터가 삭제된다.

**초기 포맷 자동화**
User Data 스크립트로 Instance Store를 자동 포맷하고 마운트하며, 애플리케이션 시작 전에 준비한다.

**캐시 워밍 전략**
인스턴스 시작 시 캐시를 자동으로 재구성하는 로직을 구현하며, S3나 DB에서 Hot Data를 미리 로드한다.

**스냅샷 대안**
중요한 상태는 주기적으로 S3로 백업하며, 인스턴스 재생성 시 자동 복원 스크립트를 준비한다.

## 제약 사항

**영속성 없음**
인스턴스 중지/종료 시 데이터가 영구 삭제되며, 복구 불가능하다.

**스냅샷 불가**
EBS와 달리 스냅샷 생성이 불가능하므로, 수동 백업이 필요하다.

**크기 변경 불가**
인스턴스 타입에 따라 크기가 고정되어 있으며, 나중에 추가하거나 확장할 수 없다.

**인스턴스 타입 변경 제약**
Instance Store 인스턴스는 중지할 수 없으므로, 인스턴스 타입 변경 시 데이터가 삭제된다.

**하드웨어 장애 위험**
호스트 서버 장애 시 데이터가 손실되며, AWS가 보증하지 않는다.

## 지원 인스턴스 타입

**스토리지 최적화**
i3, i3en, i4i, d2, d3, d3en (NVMe SSD 또는 HDD)

**범용 (d 접미사)**
c5d, c6gd, m5d, m6gd, r5d, r6gd (NVMe SSD 추가)

**컴퓨팅 최적화**
c5d, c6id, c7gd

**메모리 최적화**
r5d, r6id, x1, x1e, z1d

## 비용

Instance Store는 인스턴스 시간당 비용에 포함되어 있어 추가 비용이 없다. 그러나 Instance Store를 지원하는 인스턴스 타입(예: c5d)이 일반 타입(c5)보다 약간 비싸다.

## 요약

AWS Instance Store는 EC2 호스트 서버에 물리적으로 연결된 초고속 임시 블록 스토리지로, 인스턴스 중지/종료 시 데이터가 삭제되는 휘발성 특성을 가지며, 네트워크 지연 없이 수십만~수백만 IOPS의 극도로 높은 성능을 제공하고, 인스턴스 타입별로 크기가 고정되어 있으며, 캐시, 버퍼, 임시 파일, 복제 데이터, HPC 워크로드에 최적화되어 있고, EBS와 달리 스냅샷이 불가능하므로 중요 데이터는 주기적으로 S3/EBS로 백업해야 한다.
