# AWS Elastic Load Balancing(ELB)란?

Elastic Load Balancing은 여러 가용 영역(AZ)에 분산된 **EC2·컨테이너·온프레미스 IP·Lambda** 같은 대상(Target)에 들어오는 트래픽을 자동으로 분산해 애플리케이션 **가용성·확장성·내결함성**을 높여주는 AWS의 매니지드 로드 밸런서 서비스다.  
사용자는 하나의 엔드포인트만 제공하고, 실제 요청을 받을 백엔드 서버 증설·감소·장애 처리 등은 ELB가 알아서 수행한다.

## 1. 작동 원리

1. **클라이언트 요청 수신**  
   ELB의 DNS 이름(예: my-alb-123456.ap-northeast-2.elb.amazonaws.com)으로 트래픽이 들어온다.
2. **리스너가 포트·프로토콜 확인**  
   HTTP(80), HTTPS(443) 또는 TCP/UDP 등 설정된 리스너가 연결을 수락한다.
3. **규칙 평가 → 대상 그룹 선택**  
   URL·호스트·헤더·메서드 등 규칙에 따라 해당 대상(Target) 그룹으로 라우팅한다.
4. **헬스 체크**  
   미리 정의한 헬스 체크 경로로 백엔드 상태를 주기적으로 점검하고, 비정상 서버는 자동 제외한다.
5. **로드 밸런싱**  
   라운드 로빈, 최소 미해결 요청, 해시 등 알고리즘으로 정상 대상에 트래픽을 분산한다.
6. **오토스케일링 연동**  
   Auto Scaling 그룹에서 인스턴스가 동적으로 늘거나 줄어도 ELB가 자동 등록·해제한다.

## 2. ELB 4종류 비교

| 구분 | OSI 계층 | 최적 용도 | 특징 |
|------|----------|-----------|------|
| **Application Load Balancer (ALB)** | 7계층(L7) | HTTP/HTTPS 기반 웹·API | 경로·호스트·헤더·쿼리 매개변수 등 콘텐츠 기반 라우팅, WebSocket·gRPC 지원, WAF·OIDC 연동 |
| **Network Load Balancer (NLB)** | 4계층(L4) | 초고속 TCP/UDP·gRPC·TLS | 초당 수백만 연결 처리, 정적 IP·Elastic IP 제공, TLS 오프로드 |
| **Gateway Load Balancer (GWLB)** | 3계층(터널) | 보안·네트워크 어플라이언스 앞단 | GENEVE 터널 사용, 방화벽·IDS/IPS 같은 서드파티 가상 어플라이언스 통합 |
| **Classic Load Balancer (CLB)** | 4·7계층(이전 세대) | 레거시 이관 | 새 서비스에는 ALB/NLB 권장 |

## 3. 핵심 기능

- **자동 스케일** : 트래픽 증가 시 로드 밸런서 노드와 처리 용량을 자동 확장  
- **다중 AZ** : 최소 두 개 AZ에 걸쳐 배포돼 장애 시에도 서비스 지속  
- **TLS/SSL 오프로드** : 인증서(ACM) 장착으로 암·복호화를 ELB가 대행, 서버 CPU 절감  
- **Sticky Session** : 쿠키 기반 세션 고정으로 상태 유지 서비스 지원  
- **IP·Lambda 대상** : 서버리스·온프레미스 워크로드까지 단일 로드 밸런서로 통합  
- **Access Log & CloudWatch** : 실시간 모니터링과 로그 수집  
- **보안 통합** : IAM·SG·NACL, AWS WAF, AWS Shield와 연동

## 4. 사용 사례

1. **대규모 웹/모바일 서비스**  
   - ALB로 HTTP 트래픽 콘텐츠 기반 라우팅, Auto Scaling 그룹 연결  
2. **초저지연 게임·IoT 백엔드**  
   - NLB로 수백만 TCP 연결 처리, 정적 IP 제공  
3. **멀티티어 내부 통신**  
   - 내부 ALB/NLB를 두어 마이크로서비스 간 로드 밸런싱  
4. **보안 어플라이언스 체인**  
   - GWLB에 서드파티 가상 방화벽 묶어 흐름 검사 후 내부로 전달  
5. **Blue/Green·A/B 배포**  
   - 가중치(Wighted) 대상 그룹으로 신규 버전 트래픽을 10% → 100% 점진 전환

## 5. 비용 구조(요약)

- **시간당 로드 밸런서 노드 비용** + **L7/L4 처리량(LCU 또는 데이터 처리량) 비용**  
- 데이터 전송 비용은 Region·인터넷 방향 여부 등에 따라 별도 과금  
- 헬스 체크·로그 저장·TLS 오프로드는 사용량에 포함

## 6. 장단점 요약

| 장점 | 설명 |
|------|------|
| **완전 관리형** | 패치·고가용성·확장 자동 |
| **유연한 라우팅** | L7 규칙·L4 포트·Geo·IP 등 |
| **보안·가속 통합** | WAF, Shield, Global Accelerator 연계 |
| **서버 비용 절감** | SSL 오프로드, 상태 체크, Auto Scaling |

| 단점 | 설명 |
|------|------|
| **추가 네트워크 홉** | 밀리초 단위 지연 발생 가능 |
| **요금 구조 복잡** | LCU·데이터 전송 등 합산 필요 |
| **고급 설정 러닝커브** | 규칙·리스너·대상 그룹 이해 필요 |

## 7. 한 줄 정리

Elastic Load Balancing은 **웹·모바일·마이크로서비스·보안 워크로드의 트래픽을 자동으로 분산·확장·보호**해 주는 AWS 필수 네트워킹 서비스로, ALB·NLB·GWLB(＋CLB) 네 가지 타입으로 모든 요구 사항을 커버한다.
