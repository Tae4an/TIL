# AWS CloudFormation란?

## 개념 정의
**AWS CloudFormation**은 AWS에서 제공하는 **코드형 인프라(IaC, Infrastructure as Code) 서비스**다. JSON 또는 YAML 형식의 템플릿을 사용하여 AWS 리소스를 자동으로 프로비저닝하고 관리할 수 있다.

수동으로 리소스를 하나씩 생성하는 대신, **코드로 정의된 템플릿**을 통해 전체 인프라를 일관되게 구축하는 서비스다.

## 핵심 특징

### **코드형 인프라 관리**
- **JSON 또는 YAML** 형식으로 인프라 구성을 정의한다
- 버전 관리 시스템을 통한 인프라 변경 이력 추적이 가능하다
- Git과 같은 도구로 템플릿을 관리하여 협업과 배포 자동화를 지원한다

### **선언적 프로그래밍**
- **원하는 최종 상태**만 정의하면 CloudFormation이 자동으로 리소스를 생성한다
- 리소스 간 종속성을 자동으로 해석하여 올바른 순서로 생성한다
- 복잡한 인프라도 단순한 템플릿으로 표현 가능하다

### **완전 관리형 서비스**
- AWS가 모든 프로비저닝과 상태 관리를 담당한다
- 리소스 생성 실패 시 **자동 롤백** 기능을 제공한다
- 추가 인프라나 관리 도구 설치가 불필요하다

## 핵심 구성 요소

### **템플릿 (Template)**
- AWS 리소스와 속성을 **JSON/YAML로 정의한 블루프린트**다
- 매개변수, 조건문, 매핑 등을 활용한 동적 구성이 가능하다
- S3에 저장하거나 로컬 파일로 관리할 수 있다

### **스택 (Stack)**
- 템플릿을 실행하여 생성된 **AWS 리소스 묶음**이다
- 하나의 단위로 생성, 업데이트, 삭제가 관리된다
- 스택 삭제 시 포함된 모든 리소스가 자동으로 삭제된다

## 템플릿 구조

### **필수 섹션**
- **Resources**: 생성할 AWS 리소스 정의 (유일한 필수 섹션)

### **선택적 섹션**
- **Parameters**: 스택 생성 시 입력받을 매개변수
- **Outputs**: 스택 생성 후 반환할 값들
- **Mappings**: 키-값 매핑 테이블
- **Conditions**: 조건부 리소스 생성 로직
- **Metadata**: 템플릿에 대한 추가 정보

## 주요 장점

### **인프라 관리 간소화**
- 복잡한 다중 리소스 아키텍처를 **하나의 템플릿으로 정의** 가능하다
- Auto Scaling, 로드 밸런서, 데이터베이스 등을 자동으로 구성한다
- 리소스 간 종속성과 순서를 자동으로 관리한다

### **빠른 인프라 복제**
- 동일한 템플릿으로 **개발/스테이징/프로덕션 환경을 일관되게** 구성할 수 있다
- 여러 리전에 동일한 인프라를 신속하게 배포 가능하다
- 매개변수를 통해 환경별 차이점을 유연하게 처리한다

### **변경 사항 제어 및 추적**
- 템플릿 버전 관리를 통한 **인프라 변경 이력 추적**이 가능하다
- 변경 세트(Change Set)를 통한 사전 영향도 분석을 지원한다
- 언제든지 이전 버전으로 롤백할 수 있다

## 작동 방식

### **스택 생성 프로세스**
1. **템플릿 작성**: YAML/JSON으로 리소스 정의
2. **템플릿 업로드**: 로컬 파일 또는 S3 URL 지정
3. **매개변수 입력**: 필요시 스택별 매개변수 값 설정
4. **스택 생성**: CloudFormation이 자동으로 리소스 프로비저닝
5. **완료 알림**: 모든 리소스 생성 완료 시 상태 보고

### **에러 처리**
- 생성 중 오류 발생 시 **자동으로 이미 생성된 리소스들을 삭제**한다
- 업데이트 실패 시 이전 상태로 자동 롤백한다
- 상세한 에러 로그와 이벤트 기록을 제공한다

## 고급 기능

### **중첩 스택 (Nested Stack)**
- 여러 템플릿을 **계층적으로 구성**하여 복잡한 아키텍처 관리가 가능하다
- 재사용 가능한 컴포넌트를 모듈화하여 관리할 수 있다

### **스택셋 (StackSet)**
- **다중 계정, 다중 리전**에 동일한 스택을 배포할 수 있다
- 조직 전체의 인프라를 중앙에서 관리 가능하다

### **드리프트 탐지**
- 템플릿과 실제 리소스 상태 간의 **차이점을 자동으로 감지**한다
- 수동으로 변경된 설정을 식별하여 일관성을 유지할 수 있다

## 다른 도구와의 비교

### **vs Terraform**
- **CloudFormation**: AWS 네이티브, 무료, AWS만 지원
- **Terraform**: 멀티 클라우드, 별도 상태 관리 필요, 더 많은 프로바이더 지원

### **vs CDK**
- **CloudFormation**: 선언적 템플릿 방식
- **CDK**: 프로그래밍 언어로 인프라 정의 (최종적으로 CloudFormation 템플릿 생성)

## 주요 활용 사례

### **개발 환경 자동화**
- 개발자별 독립된 환경을 템플릿으로 표준화하여 제공한다
- CI/CD 파이프라인과 연동하여 자동 배포 환경을 구축한다

### **재해 복구 시스템**
- 프로덕션 환경의 템플릿을 다른 리전에 빠르게 복제한다
- RTO/RPO 목표 달성을 위한 자동화된 복구 프로세스를 구현한다

### **규정 준수 및 거버넌스**
- 보안 정책과 규정을 템플릿에 내장하여 일관된 규정 준수를 보장한다
- 리소스 태깅, 암호화, 액세스 제어를 자동화한다

## 제한사항 및 고려사항

### **AWS 종속성**
- AWS 전용 서비스로 다른 클라우드 환경에서는 사용 불가하다
- AWS 서비스의 업데이트에 따른 템플릿 수정이 필요할 수 있다

### **학습 곡선**
- JSON/YAML 문법과 CloudFormation 함수 이해가 필요하다
- 복잡한 템플릿은 디버깅이 어려울 수 있다

### **템플릿 크기 제한**
- 템플릿 파일 크기는 **최대 51,200바이트 (직접 업로드) 또는 460,800바이트 (S3 업로드)**로 제한된다
- 스택당 최대 **500개 리소스** 제한이 있다

AWS CloudFormation은 **안정적이고 반복 가능한 인프라 관리**를 위한 핵심 도구로, DevOps와 클라우드 네이티브 개발에서 필수적인 서비스다.
