# Amazon Kinesis란?

## 개념 정의
Amazon Kinesis는 **실시간 스트리밍 데이터를 수집·처리·분석하는 AWS의 완전 관리형 플랫폼**이다. 웹사이트 클릭스트림, IoT 센서 데이터, 애플리케이션 로그, 실시간 비디오 등 대량의 스트리밍 데이터를 초 단위·분 단위로 처리해 즉각적인 인사이트를 얻을 수 있게 해준다.

쉽게 말해 "실시간으로 끊임없이 쏟아지는 데이터를 AWS에서 자동으로 받아서 처리·분석·저장할 수 있게 해주는 스트리밍 데이터 플랫폼"이다.

## 스트리밍 데이터란?

**배치 처리 vs 스트리밍 처리**
- **배치(Batch)**: 데이터를 모았다가 특정 시점(예: 자정)에 일괄 처리
- **스트리밍(Streaming)**: 데이터가 생성되는 즉시 연속적으로 실시간 처리

**스트리밍 데이터 예시**
- 웹사이트 사용자 클릭·페이지뷰
- IoT 센서 데이터 (온도, 위치, 속도)
- 애플리케이션 로그
- 금융 거래 데이터
- 소셜 미디어 피드
- 실시간 비디오

## Kinesis의 4가지 핵심 서비스

Amazon Kinesis는 **4개의 독립적인 서비스**로 구성되어 있으며, 각각 다른 용도와 특징을 가진다.

### 1. Kinesis Data Streams (실시간 데이터 수집·처리)

**개념**
- 실시간 스트리밍 데이터를 수집하고 처리하는 **핵심 서비스**
- 커스텀 애플리케이션 구축을 위한 원시 스트림 제공
- 가장 유연하고 강력하지만 개발 필요

**핵심 구성 요소**

**샤드(Shard)**
- 스트림의 용량 단위 (처리량 측정 기준)
- 1개 샤드 = 초당 1MB 또는 1,000개 레코드 입력, 초당 2MB 출력
- 샤드 수를 늘려 수평 확장 가능

**프로듀서(Producer)**
- 데이터를 스트림에 보내는 주체
- 웹서버, 모바일 앱, IoT 기기, 로그 에이전트 등

**컨슈머(Consumer)**
- 스트림에서 데이터를 읽어 처리하는 애플리케이션
- EC2, Lambda, Kinesis Data Analytics 등

**주요 특징**
- **데이터 보존**: 기본 24시간, 최대 365일까지 확장 가능
- **재생 가능(Replayability)**: 같은 데이터를 여러 컨슈머가 독립적으로 읽기 가능 (SQS와 차이점)
- **순서 보장**: 샤드 내에서 레코드 순서 유지
- **실시간 처리**: 200ms 이하 지연

**사용 사례**
- 실시간 로그 분석
- 실시간 대시보드
- 클릭스트림 분석
- IoT 데이터 수집
- 실시간 이벤트 처리

### 2. Kinesis Data Firehose (데이터 전송·로딩)

**개념**
- 스트리밍 데이터를 **자동으로 목적지에 전달**하는 **서버리스 서비스**
- "쉬운 버튼" - 인프라 관리 불필요
- Data Streams보다 간단하지만 유연성은 낮음

**주요 기능**
- **자동 전송**: S3, Redshift, OpenSearch, Splunk, HTTP 엔드포인트로 자동 전달
- **데이터 변환**: Lambda로 전송 전 데이터 변환·필터링 가능
- **배치 처리**: 데이터를 모아서 효율적으로 전송 (약간의 지연 발생, 60초~900초)
- **자동 스케일링**: 처리량에 따라 자동 확장
- **압축**: Gzip, Snappy 등으로 자동 압축

**Data Streams vs Firehose**
| 구분 | Data Streams | Data Firehose |
|------|-------------|---------------|
| 용도 | 실시간 커스텀 처리 | 간단한 데이터 전송·로딩 |
| 지연 시간 | 200ms 이하 | 60초~900초 (배치) |
| 데이터 보존 | 최대 365일 | 보존 안 함 (바로 전송) |
| 관리 | 샤드 수동 조정 | 완전 서버리스 |
| 유연성 | 높음 (커스텀 처리) | 낮음 (목적지 제한적) |

**사용 사례**
- 로그를 S3로 자동 저장
- 실시간 데이터를 Redshift로 로딩
- OpenSearch에 로그 전송 (검색·분석)
- 데이터 레이크 구축

### 3. Kinesis Data Analytics (실시간 SQL 분석)

**개념**
- **SQL 또는 Apache Flink**를 사용해 스트리밍 데이터를 **실시간으로 분석**
- 현재 이름: **Amazon Managed Service for Apache Flink**
- 코드 없이 SQL로 실시간 분석 가능

**주요 기능**
- **표준 SQL 쿼리**: 스트리밍 데이터를 마치 테이블처럼 SQL로 분석
- **실시간 집계**: 윈도우 함수로 시간별·건수별 집계
- **이상 탐지**: 머신러닝 알고리즘 내장
- **자동 스케일링**: 처리량에 따라 자동 확장

**사용 사례**
- 실시간 대시보드 생성
- 실시간 이상 탐지 (사기, 장애)
- 실시간 지표 계산
- 스트리밍 ETL

### 4. Kinesis Video Streams (비디오 스트리밍)

**개념**
- **실시간 비디오·오디오 데이터**를 수집·저장·처리하는 서비스
- 카메라, 드론, 스마트 기기의 영상 스트리밍 전용

**주요 기능**
- **실시간 영상 전송**: 낮은 지연으로 비디오 스트리밍
- **AI 통합**: Amazon Rekognition과 연동해 얼굴 인식, 객체 탐지
- **데이터 보존**: 영상을 클라우드에 저장 후 재생 가능
- **WebRTC 지원**: 양방향 실시간 통신

**사용 사례**
- 스마트 홈 보안 카메라
- 원격 의료 영상 분석
- 자율주행 차량 영상 스트리밍
- 드론 실시간 영상 전송

## Kinesis Data Streams 상세 작동 방식

### 1. 데이터 수집(Ingestion)
```
Producer → Kinesis Stream → Shard 1, 2, 3...
```
- 프로듀서가 레코드를 스트림에 PUT
- 파티션 키(Partition Key)로 샤드 자동 배정
- 같은 파티션 키는 같은 샤드로 (순서 보장)

### 2. 데이터 처리(Processing)
```
Shard 1 → Consumer App (Lambda, EC2, Flink)
Shard 2 → Consumer App
```
- 컨슈머가 샤드에서 레코드를 순차 읽기
- 여러 컨슈머가 동시에 같은 스트림 읽기 가능
- Enhanced Fan-Out: 각 컨슈머에게 전용 처리량 제공

### 3. 예시 플로우
```
웹사이트 클릭 이벤트 
  → Kinesis Data Streams (실시간 수집)
  → Lambda (실시간 처리)
  → DynamoDB (저장)
  → Kinesis Data Firehose (배치 전송)
  → S3 (장기 보관)
  → Athena (SQL 분석)
```

## 주요 특징

**실시간(Real-time)**
- 200ms 이하 지연으로 데이터 수집·처리
- 배치 처리 대비 수초~수분 만에 인사이트 확보

**완전 관리형(Fully Managed)**
- 인프라 프로비저닝·패치·관리 불필요
- AWS가 가용성·내구성·확장성 자동 관리

**확장 가능(Scalable)**
- 초당 기가바이트~테라바이트 규모 처리
- 샤드 추가로 수평 확장
- 수십만 개 데이터 소스 동시 처리

**내구성(Durable)**
- 데이터를 여러 가용 영역(AZ)에 자동 복제
- 데이터 유실 방지

**AWS 통합**
- Lambda, S3, Redshift, OpenSearch, CloudWatch, Glue 등 다양한 AWS 서비스와 네이티브 통합

## 주요 활용 사례

**실시간 로그 분석**
- 애플리케이션·서버 로그 실시간 수집
- 오류·이상 패턴 즉시 탐지
- CloudWatch와 연동해 알림

**클릭스트림 분석**
- 웹사이트·앱 사용자 행동 실시간 추적
- 실시간 개인화 추천
- A/B 테스트 즉시 분석

**IoT 데이터 처리**
- 센서·디바이스 데이터 실시간 수집
- 예측 정비(Predictive Maintenance)
- 실시간 모니터링 대시보드

**실시간 사기 탐지**
- 금융 거래 실시간 분석
- 이상 패턴 즉시 차단
- 머신러닝 모델 실시간 적용

**실시간 추천 시스템**
- 사용자 행동 실시간 반영
- 개인화 콘텐츠 즉시 제공

**비디오 분석**
- 보안 카메라 실시간 분석
- AI로 얼굴·객체 자동 인식
- 의료 영상 원격 분석

## Kinesis vs 기타 AWS 서비스

| 서비스 | 용도 | 차이점 |
|--------|------|--------|
| **Kinesis** | 실시간 스트리밍 데이터 | 순서 보장, 재생 가능, 대용량 |
| **SQS** | 비동기 메시지 큐 | 순서 불보장(Standard), 읽으면 삭제 |
| **SNS** | Pub/Sub 메시징 | 1회성 알림, 보존 없음 |
| **EventBridge** | 이벤트 버스 | 이벤트 라우팅, 규칙 기반 |

**Kinesis는 대량의 연속 데이터를 순서 보장하며 실시간 처리할 때 최적**

## 비용

**Kinesis Data Streams**
- 샤드 시간당 과금 (약 $0.015/샤드/시간)
- PUT 요청당 과금 (약 $0.014 per 1M PUT requests)
- 데이터 보존 기간 연장 시 추가 비용
- Enhanced Fan-Out 사용 시 추가 비용

**Kinesis Data Firehose**
- 전송 데이터량 기준 (약 $0.029 per GB)
- 변환 시 Lambda 비용 별도

**Kinesis Data Analytics**
- 처리 KPU(Kinesis Processing Unit) 시간당 과금

**Kinesis Video Streams**
- 수집·저장·출력 데이터량 기준 과금

## 모범 사례

**샤드 크기 조정**
- Auto Scaling으로 트래픽에 따라 동적 조정
- CloudWatch 메트릭 모니터링
- Hot Shard 회피 (파티션 키 분산)

**데이터 보존 최적화**
- 필요 기간만 보존 (비용 절감)
- S3로 장기 보관 이관

**Enhanced Fan-Out 활용**
- 여러 컨슈머가 동시 처리 시 전용 처리량 제공
- 처리 지연 최소화

**파티션 키 설계**
- 균등 분산되도록 설계
- 핫 파티션 방지

## 요약

Amazon Kinesis는 실시간 스트리밍 데이터를 수집·처리·분석하는 AWS 완전 관리형 플랫폼으로, 4가지 핵심 서비스(Data Streams, Firehose, Data Analytics, Video Streams)로 구성된다. 웹 클릭스트림, IoT 센서, 로그, 실시간 비디오 등 초당 기가바이트 규모의 데이터를 200ms 이하 지연으로 처리해 즉각적인 인사이트와 실시간 대응을 가능하게 하며, 실시간 분석·사기 탐지·개인화·모니터링 등 다양한 분야에서 활용된다.
