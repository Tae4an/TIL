# CIEM이란?

## 개념 정의
CIEM(Cloud Infrastructure Entitlement Management, 클라우드 인프라 권한 관리)은 **클라우드 환경에서 사용자·서비스·리소스의 권한(Entitlement)과 접근 권리를 가시화하고, 과도한 권한을 식별·제거하여 최소 권한 원칙을 자동화하는 보안 솔루션** 이다. 멀티클라우드 환경에서 복잡하게 얽힌 IAM 정책·역할·권한을 중앙에서 관리하고, 권한 확산(Permission Creep)과 내부자 위협을 방지한다.

쉽게 말해 "클라우드에서 누가 무엇에 접근할 수 있는지 파악하고, 과도한 권한을 자동으로 찾아내서 최소 권한으로 조정해주는 IAM 보안 플랫폼"이다.

## 핵심 특징

**권한 가시성 제공**
- 클라우드 전체의 모든 권한(Entitlement) 자동 발견·분류
- 사람(Human), 서비스 계정(Service Account), 머신 아이덴티티(API Key, 토큰 등)의 권한 매핑
- "누가 무엇에 접근할 수 있는가" 명확하게 시각화

**과도한 권한 탐지**
- 실제 사용하지 않는 권한(Unused Permission) 식별
- 필요 이상의 권한(Over-privileged) 탐지
- 와일드카드(*) 권한, Admin 권한 남용 등 위험 권한 발견

**최소 권한 원칍 자동화(Least Privilege Enforcement)**
- 실제 사용 패턴 분석 후 필요 최소 권한만 부여
- 자동 권한 조정 또는 권장 정책 제시
- 권한 요청·승인·철회 워크플로 자동화

**멀티클라우드 통합 관리**
- AWS, Azure, GCP 등 각 CSP의 고유한 IAM 체계를 통합 관리
- 표준화된 정책 언어로 일관성 있는 권한 관리
- 단일 대시보드로 전체 클라우드 권한 현황 파악

**이상 행위 탐지**
- 머신러닝·UEBA(User and Entity Behavior Analytics)로 비정상 접근 패턴 감지
- 권한 상승(Privilege Escalation), 측면 이동(Lateral Movement) 시도 탐지
- 독성 조합(Toxic Combination): 여러 권한 조합이 위험한 경우 경고

**규정 준수 및 감사**
- 접근 권한 변경 이력 추적(Audit Trail)
- 규정 준수(PCI DSS, HIPAA, SOC 2) 자동 점검
- 감사 리포트 자동 생성

## CIEM이 해결하는 문제

**클라우드 권한의 복잡성**
- AWS IAM만 해도 수천 개의 권한, 복잡한 정책 구조
- Azure RBAC, GCP IAM 등 각 CSP마다 다른 권한 체계
- 멀티클라우드 환경에서 일관된 권한 관리 거의 불가능

**권한 확산(Permission Creep)**
- 시간이 지나면서 불필요한 권한이 누적
- 퇴사자·프로젝트 종료 후에도 권한 미회수
- "일단 Admin 권한" 관행으로 과도한 권한 부여

**클라우드 아이덴티티 부채(Cloud Identity Debt)**
- 사용되지 않는 계정·권한이 쌓여감
- 공격 표면(Attack Surface) 확대
- 관리 부담 증가

**내부자 위협 및 실수**
- 과도한 권한으로 인한 의도치 않은 데이터 삭제·노출
- 악의적 내부자가 권한 남용
- 계정 탈취 시 피해 범위 확대

**멀티클라우드 가시성 부족**
- 누가 어디에 무슨 권한이 있는지 파악 어려움
- 섀도우 IT, 미승인 권한 발견 불가

## 주요 기능

### 1. 권한 발견 및 인벤토리
- 모든 클라우드 계정·사용자·서비스·머신 아이덴티티의 권한 자동 수집
- 역할(Role), 정책(Policy), 그룹(Group), 자격증명(Credentials) 매핑
- 숨겨진·잊혀진 계정·권한 발견

### 2. 권한 분석 및 평가
- 각 아이덴티티가 가진 유효 권한(Effective Permission) 계산
- 실제 사용 여부 추적: 90일간 미사용 권한 식별
- 위험도 평가: Admin, Wildcard, 민감 리소스 접근 권한 등

### 3. 최소 권한 권고
- 실제 사용 패턴 기반 권장 정책 생성
- "현재 권한 vs 필요 권한" 비교
- 단계별 권한 축소 로드맵 제시

### 4. 자동 권한 조정
- 자동으로 과도한 권한 제거
- 정책 수정 자동 적용(승인 후)
- IaC(Terraform, CloudFormation)와 통합

### 5. 권한 시각화
- 권한 관계도(Graph): 누가 무엇에 접근 가능한지 시각적 표현
- 공격 경로(Attack Path) 분석: 권한 체인을 통한 잠재적 공격 시뮬레이션
- 크로스 클라우드 권한 맵

### 6. 이상 행위 탐지
- 평소와 다른 접근 패턴 감지
- 권한 상승 시도, 측면 이동, 비정상 API 호출
- 머신러닝 기반 위협 스코어링

### 7. 권한 수명주기 관리
- 임시 권한(Just-in-Time Access): 필요 시점에만 권한 부여
- 자동 만료: 일정 기간 후 권한 자동 회수
- 승인 워크플로: 권한 요청→승인→부여→철회 자동화

### 8. 규정 준수 리포팅
- 접근 권한 변경 이력 추적
- 규정 위반 권한 자동 탐지
- 감사 리포트 자동 생성

## CIEM 작동 방식

### 1. 데이터 수집
- CSP API를 통해 IAM 정책, 역할, 사용자, 그룹, 자격증명 수집
- CloudTrail, Azure Activity Log 등에서 권한 사용 이력 수집

### 2. 권한 정규화(Normalization)
- AWS, Azure, GCP의 서로 다른 권한 체계를 표준 포맷으로 변환
- 통합 권한 모델 생성

### 3. 분석 및 평가
- 각 아이덴티티의 유효 권한 계산
- 실제 사용 여부, 위험도, 민감도 평가
- 독성 조합, 권한 체인 분석

### 4. 권고 및 자동화
- 최소 권한 정책 생성
- 자동 또는 수동 수정
- 지속적 모니터링

## CIEM vs 관련 개념

| 구분 | CIEM | IAM | CSPM | CWPP |
|------|------|-----|------|------|
| 초점 | 클라우드 권한·자격증명 관리 | 인증·인가 시스템 자체 | 인프라 구성 오류 | 워크로드 런타임 보호 |
| 주요 대상 | 권한, 정책, 역할, 자격증명 | 사용자, 그룹, 인증 | 리소스 설정 | 실행 중인 프로세스 |
| 핵심 기능 | 과도한 권한 탐지·최소 권한 | 인증·접근 제어 | 구성 검증 | 멀웨어·침입 차단 |
| 예시 | 미사용 Admin 권한 제거 | MFA, SSO 설정 | S3 퍼블릭 차단 | 컨테이너 멀웨어 차단 |

## 주요 활용 사례

**멀티클라우드 권한 통합 관리**
- AWS, Azure, GCP 권한을 하나의 대시보드에서 관리
- 일관된 최소 권한 정책 적용

**권한 확산 방지**
- 정기적으로 미사용·과도한 권한 정리
- 클라우드 아이덴티티 부채 해소

**내부자 위협 완화**
- 과도한 권한으로 인한 우발적·악의적 데이터 노출 방지
- 이상 행위 조기 탐지

**규정 준수 자동화**
- PCI DSS, SOC 2, HIPAA 등 접근 제어 요구사항 자동 검증
- 감사 리포트 즉시 생성

**Just-in-Time Access**
- 필요 시점에만 권한 부여, 사용 후 자동 회수
- 공격 표면 최소화

**DevOps 보안 강화**
- 개발자·CI/CD 파이프라인의 과도한 권한 차단
- IaC 코드 내 권한 정책 검증

## 주요 CIEM 솔루션

**전문 CIEM 솔루션**
- SailPoint (IGA + CIEM)
- CyberArk (PAM + CIEM)
- Ermetic, Sonrai Security (CIEM 전문)

**CNAPP 통합 플랫폼**
- Wiz, Orca Security, Prisma Cloud (Palo Alto)
- Crowdstrike, Lacework
- Microsoft Defender for Cloud
- AWS IAM Access Analyzer (AWS 네이티브)

## 실무 도입·운영 팁

**초기 평가**
- 현재 권한 현황 전수 조사
- 과도한 권한·미사용 계정 파악
- 우선순위 설정(높은 위험도부터)

**점진적 권한 축소**
- 한 번에 모든 권한 축소하지 말고 단계적 접근
- 테스트 환경에서 먼저 검증
- 영향 분석 후 프로덕션 적용

**자동화 활용**
- 정책 자동 생성·적용
- 주기적 권한 리뷰 자동화
- 임시 권한 자동 만료

**팀 협업**
- 보안팀·인프라팀·개발팀 공동 책임
- 권한 요청·승인 프로세스 명확화
- 정기 리뷰 미팅

**지속적 모니터링**
- 권한 변경 알림 설정
- 이상 행위 탐지 대응 절차 수립
- 정기 감사 리포트 생성

## 요약

CIEM은 클라우드 환경의 복잡한 권한·자격증명을 가시화하고, 과도한 권한을 자동으로 탐지·제거하여 최소 권한 원칙을 실현하는 보안 솔루션이다. 멀티클라우드 IAM 통합 관리, 권한 확산 방지, 내부자 위협 완화, 규정 준수 자동화에 필수적이며, CSPM·CWPP와 함께 CNAPP의 핵심 구성 요소로 자리잡고 있다.
