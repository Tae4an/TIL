# CWPP(Cloud Workload Protection Platform)란?

## 개념 정의
CWPP(Cloud Workload Protection Platform, 클라우드 워크로드 보호 플랫폼)는 **클라우드 환경에서 실행되는 워크로드(VM, 컨테이너, 서버리스 등)를 실시간으로 모니터링하고 위협으로부터 보호하는 통합 보안 솔루션**이다. 개발부터 런타임까지 전 수명주기에 걸쳐 워크로드의 보안을 보장하며, 멀티클라우드·하이브리드 환경에서 일관된 보안 정책을 적용한다.

쉽게 말해 "클라우드에서 돌아가는 서버·컨테이너·함수 등 실제 워크로드를 실시간으로 지키는 보안 플랫폼"이다.

## 핵심 특징

**워크로드 중심 보호**
- CSPM이 인프라 구성을 보는 것과 달리, CWPP는 실행 중인 워크로드(프로세스, 애플리케이션, 데이터)를 보호
- VM, 컨테이너(Docker, Kubernetes), 서버리스(Lambda, Cloud Functions) 모두 지원
- 물리 서버, 가상 머신, 컨테이너, 서버리스 함수 등 다양한 워크로드 타입 커버

**런타임 보호(Runtime Protection)**
- 워크로드가 실행되는 동안 실시간으로 위협 탐지·차단
- 행위 분석(Behavioral Analysis), 머신러닝, AI로 비정상 활동 감지
- 멀웨어, 랜섬웨어, 제로데이 공격, 파일리스 공격 등 실시간 차단

**개발부터 운영까지 전 수명주기 보호**
- CI/CD 파이프라인에 통합: 빌드·배포 전 취약점 스캔
- 컨테이너 이미지 스캔: 배포 전 악성 코드·취약점 탐지
- 런타임 모니터링: 배포 후 실행 중인 워크로드 보호

**에이전트 기반 + 에이전트리스 지원**
- 에이전트 방식: 워크로드에 경량 에이전트 설치, 깊은 가시성·제어 제공
- 에이전트리스: API 기반으로 에이전트 없이도 스캔·모니터링(제한적)
- 두 방식을 결합해 사각지대 최소화

**멀티클라우드·하이브리드 지원**
- AWS, Azure, GCP, 온프레미스, 엣지 등 모든 환경에서 일관된 보안
- 단일 콘솔로 통합 관리

**DevSecOps 통합**
- CI/CD 파이프라인에 자동 보안 검사 삽입
- Shift Left: 개발 초기 단계부터 보안 검증
- IaC(Infrastructure as Code) 스캔

## 주요 기능

### 1. 취약점 관리(Vulnerability Management)
- OS, 애플리케이션, 라이브러리, 종속성의 알려진 취약점(CVE) 스캔
- 위험도·영향도 기반 우선순위 지정
- 패치 관리 통합 또는 권장 사항 제공

### 2. 컨테이너·Kubernetes 보안
- 컨테이너 이미지 스캔(레지스트리·빌드 타임)
- 런타임 컨테이너 행위 모니터링
- Kubernetes 보안 정책(RBAC, Pod Security, Network Policy) 검증
- 컨테이너 이스케이프(탈출) 방지

### 3. 런타임 보호·위협 탐지
- 프로세스·파일·네트워크 활동 실시간 모니터링
- 비정상 행위 탐지(예: 예상치 못한 네트워크 연결, 권한 상승, 파일 암호화)
- 멀웨어·랜섬웨어·크립토마이너·루트킷 차단
- 제로데이·파일리스 공격 대응

### 4. 침입 탐지·방지(IDS/IPS)
- 호스트 기반 침입 탐지(HIDS)
- 알려진 공격 패턴·시그니처 기반 탐지
- 이상 트래픽·프로세스 차단

### 5. 네트워크 세분화(Microsegmentation)
- 워크로드 간 통신을 세밀하게 제어
- 동서향(East-West) 트래픽 가시성·제어
- 제로 트러스트 네트워크 구현

### 6. 애플리케이션 화이트리스팅
- 허용된 애플리케이션·프로세스만 실행 가능
- 미승인 소프트웨어 실행 차단
- 드리프트(Drift) 탐지: 승인된 구성에서 벗어난 변경 감지

### 7. 규정 준수·감사
- CIS Benchmark, PCI DSS, HIPAA, SOC 2 등 준수 상태 평가
- 워크로드 구성·활동 감사 로그 수집
- 컴플라이언스 리포트 자동 생성

### 8. 서버리스 보호
- Lambda, Azure Functions, Cloud Functions 보안
- 함수 코드·종속성 취약점 스캔
- 런타임 실행 모니터링·이상 행위 탐지

### 9. 파일 무결성 모니터링(FIM)
- 중요 파일·디렉토리 변경 감지
- 무단 수정·삭제 알림

### 10. 자동화된 대응(Automated Response)
- 위협 탐지 시 자동 격리·차단·종료
- SOAR 연동으로 사고 대응 플레이북 실행
- 알림(Slack, PagerDuty, Jira 등)

## CWPP 작동 방식

### 1. 에이전트 배포
- 워크로드(VM, 컨테이너, 호스트)에 경량 에이전트 설치
- 에이전트는 프로세스, 파일, 네트워크, 시스템 콜 모니터링

### 2. 데이터 수집·분석
- 에이전트가 워크로드 활동 데이터를 중앙 플랫폼으로 전송
- 머신러닝·행위 분석으로 정상 베이스라인 학습

### 3. 위협 탐지
- 패턴 매칭, 시그니처, 행위 분석, 머신러닝으로 위협 감지
- 위협 인텔리전스 피드 연동

### 4. 자동 대응
- 탐지된 위협을 자동 차단·격리·종료
- 보안팀에 알림 전송

### 5. 가시성 제공
- 통합 대시보드로 모든 워크로드 보안 상태 시각화
- 위협 추세, 취약점 현황, 준수 상태 리포트

## CSPM vs CWPP 비교

| 구분 | CSPM | CWPP |
|------|------|------|
| 초점 | 클라우드 인프라 구성 | 워크로드 런타임 보호 |
| 주요 대상 | S3, IAM, VPC, 보안 그룹 등 인프라 설정 | VM, 컨테이너, 서버리스 등 실행 중인 워크로드 |
| 보호 시점 | 구성 오류 사전 탐지(Posture) | 런타임 위협 실시간 차단 |
| 주요 기능 | 구성 검증, 규정 준수, 드리프트 탐지 | 취약점 스캔, 침입 탐지/방지, 멀웨어 차단 |
| 방식 | 에이전트리스(API 기반) | 에이전트 기반 (일부 에이전트리스) |
| 예시 | S3 퍼블릭 접근 차단, IAM 과다 권한 탐지 | 컨테이너에서 실행 중인 멀웨어 차단, 랜섬웨어 방지 |

**비유:**
- CSPM = 건물 설계도·문·자물쇠가 제대로 되어 있는지 점검
- CWPP = 건물 안에서 움직이는 사람·활동을 실시간 감시·보호

## CWPP + CSPM = CNAPP

**CNAPP(Cloud-Native Application Protection Platform)**
- CSPM + CWPP + CIEM + 기타 보안 기능을 통합한 올인원 플랫폼
- 개발부터 런타임까지 전체 클라우드 보안 라이프사이클 커버
- 현대 클라우드 보안의 추세는 CNAPP로 통합

## 주요 활용 사례

**컨테이너·Kubernetes 환경 보호**
- 마이크로서비스 아키텍처의 컨테이너 보안
- Kubernetes 클러스터 런타임 보호

**서버리스 애플리케이션 보안**
- Lambda, Cloud Functions 코드·실행 모니터링
- 서버리스 특유의 공격(함수 인젝션 등) 방어

**멀티클라우드 워크로드 통합 관리**
- AWS, Azure, GCP 혼재 환경에서 일관된 보안
- 단일 콘솔로 전체 워크로드 가시성 확보

**DevSecOps 구현**
- CI/CD 파이프라인에 보안 자동화
- 빌드·배포 전 취약점·멀웨어 스캔

**규정 준수 자동화**
- PCI DSS, HIPAA 등 워크로드 수준 준수 검증
- 감사 리포트 자동 생성

**제로 트러스트 네트워크**
- 워크로드 간 통신 세밀 제어
- 동서향 트래픽 가시성·정책 적용

## 주요 CWPP 솔루션

**클라우드 네이티브**
- AWS GuardDuty, Amazon Inspector
- Azure Defender for Cloud (구 Azure Security Center)
- Google Cloud Security Command Center

**서드파티/전문 솔루션**
- Palo Alto Prisma Cloud
- Crowdstrike Falcon Cloud Workload Protection
- Wiz, Orca Security (CNAPP)
- Aqua Security, Sysdig (컨테이너 특화)
- Trend Micro Cloud One
- Lacework

## 실무 도입·운영 팁

**에이전트 배포 전략**
- 자동 배포 스크립트 작성(Ansible, Terraform, Kubernetes DaemonSet)
- 단계별 롤아웃: 개발→스테이징→프로덕션
- 성능 영향 최소화 검증

**베이스라인 설정**
- 정상 워크로드 행위 학습 기간 확보
- False Positive 줄이기 위한 화이트리스트 관리

**자동 대응 설정**
- 초기엔 탐지·알림만(Detect & Alert)
- 검증 후 자동 차단(Block) 단계적 확대
- 중요 워크로드는 수동 승인 프로세스 유지

**CI/CD 통합**
- 빌드 단계에 이미지 스캔 추가
- 취약점 발견 시 빌드 실패 정책 설정
- 개발자에게 즉각 피드백

**성능 모니터링**
- 에이전트 리소스 사용량 추적(CPU, 메모리, 네트워크)
- 워크로드 성능 저하 없도록 조정

**팀 협업**
- 보안팀·DevOps·개발팀 공동 운영
- 알림·티켓 자동화, 명확한 대응 절차 수립

## 요약

CWPP는 클라우드에서 실행되는 워크로드(VM, 컨테이너, 서버리스)를 런타임에 실시간으로 보호하는 보안 플랫폼으로, 취약점 관리, 침입 탐지·방지, 멀웨어 차단, 행위 분석 등을 통합 제공한다. CSPM이 "설정 오류" 중심이라면, CWPP는 "실행 중인 위협" 중심이며, 두 기능을 통합한 CNAPP가 현대 클라우드 보안의 표준으로 자리잡고 있다.
