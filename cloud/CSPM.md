# CSPM (Cloud Security Posture Management)란?

## 개념 정의
CSPM(Cloud Security Posture Management, 클라우드 보안 태세 관리)은 **클라우드 인프라의 보안 구성 오류(Misconfiguration)와 규정 준수 위반을 지속적으로 모니터링·탐지·수정하는 자동화된 보안 관리 체계**다. 클라우드 환경의 보안 상태를 가시화하고, 위험을 평가하며, 자동 또는 권장 조치로 보안 태세를 개선한다.

쉽게 말해 "클라우드 설정 오류와 보안 위험을 실시간으로 찾아내고 고쳐주는 자동화된 클라우드 보안 경찰"이다.

## 핵심 특징

**지속적인 가시성 제공**
- 멀티클라우드·하이브리드 환경(AWS, Azure, GCP 등) 전체를 단일 대시보드에서 통합 관리
- 모든 클라우드 리소스·구성·관계·의존성을 중앙에서 시각화
- 보안 사각지대 제거

**자동 오류 탐지**
- 클라우드 구성을 보안 베스트 프랙티스·정책과 비교해 위반 사항 자동 탐지
- 에이전트리스(Agentless) 방식: CSP API 연동으로 별도 에이전트 설치 불필요
- S3 퍼블릭 공개, 과도한 IAM 권한, 암호화 미적용, 보안 그룹 오픈 등 탐지

**실시간 모니터링**
- 클라우드 환경 변경 사항을 실시간 추적
- 새로운 리소스 생성·설정 변경 시 즉시 평가
- 빠르게 변하는 클라우드 환경에서 상시 보안 검증

**규정 준수 자동화**
- CIS Benchmark, PCI DSS, HIPAA, GDPR, NIST, ISO 27001 등 표준 프레임워크 기반 자동 점검
- 규정 준수 상태를 대시보드로 시각화, 감사 리포트 자동 생성
- 규정 변경 시 자동 업데이트 및 재평가

**위험 우선순위화**
- 탐지된 모든 이슈에 위험도 점수 부여
- 공격 가능성, 잠재적 영향도, 데이터 민감도 등을 고려한 우선순위 산정
- 중요도 높은 위험부터 처리 가능

**자동 또는 가이드 수정(Remediation)**
- 자동 수정: 정책에 따라 오류를 즉시 자동 해결(예: 퍼블릭 S3 버킷 자동 차단)
- 수동 수정: 단계별 가이드 제공, 승인 후 적용
- IaC(Infrastructure as Code) 통합: Terraform, CloudFormation 템플릿 수정 제안

**DevOps·CI/CD 통합**
- 배포 전 보안 검증(Shift Left)
- IaC 코드 스캔으로 배포 전 오류 차단
- 개발·배포 파이프라인에 보안 자동화 내장

## 주요 기능

### 1. 구성 오류 탐지
- S3 버킷 퍼블릭 접근 허용
- 과도한 IAM 권한(Wildcard *)
- 암호화 미적용(EBS, RDS, S3 등)
- 보안 그룹 0.0.0.0/0 오픈
- 로깅·모니터링 비활성화(CloudTrail, VPC Flow Logs)
- 패치되지 않은 인스턴스

### 2. 규정 준수 점검
- 표준 프레임워크 자동 매핑
- 컨트롤별 준수 여부 평가
- 준수율 대시보드 및 트렌드 분석
- 감사 리포트 자동 생성

### 3. 인벤토리 관리
- 모든 클라우드 자산 자동 발견·분류
- 섀도우 IT(미승인 리소스) 탐지
- 자산 관계·의존성 매핑

### 4. 위협 탐지
- 이상 행위 탐지(예: 비정상 API 호출)
- 악성 IP·도메인 접근 감지
- 의심스러운 권한 변경 알림

### 5. 리스크 평가
- 전체 보안 태세 점수(Security Posture Score)
- 공격 경로(Attack Path) 분석
- 데이터 노출 위험 평가

### 6. 알림 및 리포팅
- 실시간 알림(Slack, Email, SMS, PagerDuty)
- 경영진용 요약 리포트
- 기술팀용 상세 리포트

## CSPM의 필요성

**클라우드 환경의 복잡성**
- 수십~수백 개 서비스, 수천~수만 개 리소스
- 수시로 변경되는 구성
- 멀티클라우드·하이브리드 환경의 일관된 보안 관리 어려움

**구성 오류가 #1 보안 위협**
- Gartner 조사: 클라우드 보안 사고의 99%가 고객 측 구성 오류
- 실수로 퍼블릭 S3, 과도한 권한, 암호화 누락 등이 데이터 유출로 이어짐

**규정 준수 부담**
- 산업별·국가별 다양한 규제 동시 준수
- 수동 점검은 시간·비용 과다, 실수 가능성 높음

**DevOps 속도와 보안 균형**
- 빠른 배포 vs 보안 검토 딜레마
- CSPM으로 자동화해 속도 유지하며 보안 확보

## CSPM vs 관련 개념

| 개념 | 주요 역할 | 차이점 |
|------|----------|--------|
| CSPM | 클라우드 구성 오류·규정 준수 | 인프라·설정 중심 |
| CWPP | 워크로드(VM, 컨테이너) 런타임 보호 | 실행 중인 워크로드 보안 |
| CIEM | 클라우드 권한·자격증명 관리 | IAM·권한 특화 |
| CASB | SaaS 애플리케이션 보안·가시성 | SaaS 계층 보안 |
| CNAPP | CSPM+CWPP+CIEM+기타 통합 | 종합 클라우드 보안 플랫폼 |

CSPM은 **"클라우드 인프라 구성"** 중심, CWPP는 **"실행 중인 워크로드"** 중심이다. CNAPP는 이 둘을 포함한 올인원 플랫폼이다.

## 주요 활용 사례

**멀티클라우드 보안 통합 관리**
- AWS, Azure, GCP를 하나의 대시보드에서 관리
- 일관된 보안 정책 적용

**규정 준수 자동화**
- PCI DSS, HIPAA, GDPR 등 자동 점검
- 감사 준비 시간 단축

**보안 사고 예방**
- 퍼블릭 노출, 권한 과다 등 위험 사전 차단
- 데이터 유출·침해 사고 방지

**DevSecOps 구현**
- IaC 스캔으로 배포 전 보안 검증
- CI/CD 파이프라인 통합

**섀도우 IT 관리**
- 미승인·관리되지 않는 클라우드 리소스 발견
- 거버넌스 강화

## 주요 CSPM 솔루션

**클라우드 네이티브**
- AWS Security Hub
- Azure Defender for Cloud (구 Azure Security Center)
- Google Cloud Security Command Center

**서드파티/통합 플랫폼**
- Wiz, Prisma Cloud (Palo Alto Networks)
- Orca Security, Crowdstrike Falcon Cloud Security
- Lacework, Aqua Security
- Snyk, Trend Micro Cloud One

## 실무 도입·운영 팁

**초기 설정**
- 모든 클라우드 계정 연결(Read-Only 권한으로 시작 가능)
- 적용할 정책·프레임워크 선택(CIS, PCI 등)
- 베이스라인 평가 후 우선순위 설정

**정책 커스터마이징**
- 조직 고유 정책 추가
- False Positive 줄이기 위한 예외 규칙 설정
- 중요도·영향도 기준 조정

**자동 수정 활용**
- 초기엔 알림만(Alert-Only) 모드 운영
- 검증 후 자동 수정(Auto-Remediation) 단계적 확대
- 중요 리소스는 수동 승인 프로세스 유지

**DevOps 통합**
- IaC 스캔을 Git pre-commit hook에 통합
- CI/CD 파이프라인에 CSPM 검증 단계 추가
- 개발자에게 즉각적인 피드백 제공

**지속적 개선**
- 주간·월간 보안 태세 트렌드 분석
- 반복되는 오류 패턴 교육·프로세스 개선
- 정책 업데이트 및 규정 변경 반영

**팀 협업**
- 보안팀·DevOps팀·클라우드팀 공동 책임
- 알림·티켓 자동화(Jira, ServiceNow 연동)
- 정기 리뷰·회고 미팅

## 요약

CSPM은 클라우드 환경의 구성 오류와 규정 준수 위반을 지속적으로 모니터링·탐지·수정하는 필수 보안 도구로, 멀티클라우드 시대의 보안 사고 예방과 규제 대응의 핵심 솔루션이다. 에이전트리스 자동화, 실시간 가시성, DevOps 통합을 통해 빠른 클라우드 환경에서도 강력한 보안 태세를 유지할 수 있게 해준다.
